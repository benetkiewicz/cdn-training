---
import { getSession } from "auth-astro/server";
import Layout from "../layouts/Layout.astro";

const session = await getSession(Astro.request);
---

<Layout title="Profile">
    <main class="container">
        <h1>Profile</h1>

        {
            session ? (
                <div>
                    <h2>Welcome, {session.user?.name || "User"}</h2>

                    <div>
                        <p>
                            <strong>Email:</strong> {session.user?.email || "Not provided"}
                        </p>
                    </div>

                    <a href="/api/auth/signout">Sign Out</a>
                </div>
            ) : (
                <div>
                    <p>You need to be signed in to view this page.</p>
                    <a href="/api/auth/signin">Sign In with GitHub</a>
                </div>
            )
        }
    </main>
</Layout>
